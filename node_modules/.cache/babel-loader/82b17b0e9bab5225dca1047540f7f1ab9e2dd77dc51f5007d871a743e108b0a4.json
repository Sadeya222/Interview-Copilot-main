{"ast":null,"code":"// Copyright (c) Microsoft Corporation. All rights reserved.\n// Licensed under the MIT license.\n/* eslint-disable max-classes-per-file */\nimport { CancellationErrorCodePropertyName } from \"../common.speech/Exports.js\";\nimport { CancellationDetailsBase, CancellationErrorCode, CancellationReason, PropertyCollection, PropertyId, ResultReason } from \"./Exports.js\";\nexport var SpeakerRecognitionResultType;\n(function (SpeakerRecognitionResultType) {\n  SpeakerRecognitionResultType[SpeakerRecognitionResultType[\"Verify\"] = 0] = \"Verify\";\n  SpeakerRecognitionResultType[SpeakerRecognitionResultType[\"Identify\"] = 1] = \"Identify\";\n})(SpeakerRecognitionResultType || (SpeakerRecognitionResultType = {}));\n/**\n * Output format\n * @class SpeakerRecognitionResult\n */\nexport class SpeakerRecognitionResult {\n  constructor(response, resultReason = ResultReason.RecognizedSpeaker, cancellationErrorCode = CancellationErrorCode.NoError, errorDetails = \"\") {\n    this.privProperties = new PropertyCollection();\n    const resultType = response.scenario === \"TextIndependentIdentification\" ? SpeakerRecognitionResultType.Identify : SpeakerRecognitionResultType.Verify;\n    this.privReason = resultReason;\n    if (this.privReason !== ResultReason.Canceled) {\n      if (resultType === SpeakerRecognitionResultType.Identify) {\n        this.privProfileId = response.identificationResult.identifiedProfile.profileId;\n        this.privScore = response.identificationResult.identifiedProfile.score;\n        this.privReason = ResultReason.RecognizedSpeakers;\n      } else {\n        this.privScore = response.verificationResult.score;\n        if (response.verificationResult.recognitionResult.toLowerCase() !== \"accept\") {\n          this.privReason = ResultReason.NoMatch;\n        }\n        if (response.verificationResult.profileId !== undefined && response.verificationResult.profileId !== \"\") {\n          this.privProfileId = response.verificationResult.profileId;\n        }\n      }\n    } else {\n      this.privErrorDetails = errorDetails;\n      this.privProperties.setProperty(CancellationErrorCodePropertyName, CancellationErrorCode[cancellationErrorCode]);\n    }\n    this.privProperties.setProperty(PropertyId.SpeechServiceResponse_JsonResult, JSON.stringify(response));\n  }\n  get properties() {\n    return this.privProperties;\n  }\n  get reason() {\n    return this.privReason;\n  }\n  get profileId() {\n    return this.privProfileId;\n  }\n  get errorDetails() {\n    return this.privErrorDetails;\n  }\n  get score() {\n    return this.privScore;\n  }\n}\n/**\n * @class SpeakerRecognitionCancellationDetails\n */\nexport class SpeakerRecognitionCancellationDetails extends CancellationDetailsBase {\n  constructor(reason, errorDetails, errorCode) {\n    super(reason, errorDetails, errorCode);\n  }\n  /**\n   * Creates an instance of SpeakerRecognitionCancellationDetails object for the canceled SpeakerRecognitionResult\n   * @member SpeakerRecognitionCancellationDetails.fromResult\n   * @function\n   * @public\n   * @param {SpeakerRecognitionResult} result - The result that was canceled.\n   * @returns {SpeakerRecognitionCancellationDetails} The cancellation details object being created.\n   */\n  static fromResult(result) {\n    const reason = CancellationReason.Error;\n    let errorCode = CancellationErrorCode.NoError;\n    if (!!result.properties) {\n      errorCode = CancellationErrorCode[result.properties.getProperty(CancellationErrorCodePropertyName, CancellationErrorCode[CancellationErrorCode.NoError])];\n    }\n    return new SpeakerRecognitionCancellationDetails(reason, result.errorDetails, errorCode);\n  }\n}","map":{"version":3,"names":["CancellationErrorCodePropertyName","CancellationDetailsBase","CancellationErrorCode","CancellationReason","PropertyCollection","PropertyId","ResultReason","SpeakerRecognitionResultType","SpeakerRecognitionResult","constructor","response","resultReason","RecognizedSpeaker","cancellationErrorCode","NoError","errorDetails","privProperties","resultType","scenario","Identify","Verify","privReason","Canceled","privProfileId","identificationResult","identifiedProfile","profileId","privScore","score","RecognizedSpeakers","verificationResult","recognitionResult","toLowerCase","NoMatch","undefined","privErrorDetails","setProperty","SpeechServiceResponse_JsonResult","JSON","stringify","properties","reason","SpeakerRecognitionCancellationDetails","errorCode","fromResult","result","Error","getProperty"],"sources":["src/sdk/SpeakerRecognitionResult.ts"],"sourcesContent":["// Copyright (c) Microsoft Corporation. All rights reserved.\r\n// Licensed under the MIT license.\r\n\r\n/* eslint-disable max-classes-per-file */\r\nimport { CancellationErrorCodePropertyName, SpeakerResponse } from \"../common.speech/Exports.js\";\r\nimport {\r\n    CancellationDetailsBase,\r\n    CancellationErrorCode,\r\n    CancellationReason,\r\n    PropertyCollection,\r\n    PropertyId,\r\n    ResultReason,\r\n} from \"./Exports.js\";\r\n\r\nexport enum SpeakerRecognitionResultType {\r\n    Verify,\r\n    Identify\r\n}\r\n\r\n/**\r\n * Output format\r\n * @class SpeakerRecognitionResult\r\n */\r\nexport class SpeakerRecognitionResult {\r\n    private privReason: ResultReason;\r\n    private privProperties: PropertyCollection;\r\n    private privProfileId: string;\r\n    private privScore: number;\r\n    private privErrorDetails: string;\r\n\r\n    public constructor(response: SpeakerResponse, resultReason: ResultReason = ResultReason.RecognizedSpeaker, cancellationErrorCode: CancellationErrorCode = CancellationErrorCode.NoError, errorDetails: string = \"\") {\r\n        this.privProperties = new PropertyCollection();\r\n        const resultType = response.scenario === \"TextIndependentIdentification\" ? SpeakerRecognitionResultType.Identify : SpeakerRecognitionResultType.Verify;\r\n        this.privReason = resultReason;\r\n        if (this.privReason !== ResultReason.Canceled) {\r\n            if (resultType === SpeakerRecognitionResultType.Identify) {\r\n                this.privProfileId = response.identificationResult.identifiedProfile.profileId;\r\n                this.privScore = response.identificationResult.identifiedProfile.score;\r\n                this.privReason = ResultReason.RecognizedSpeakers;\r\n            } else {\r\n                this.privScore = response.verificationResult.score;\r\n                if (response.verificationResult.recognitionResult.toLowerCase() !== \"accept\") {\r\n                    this.privReason = ResultReason.NoMatch;\r\n                }\r\n                if (response.verificationResult.profileId !== undefined && response.verificationResult.profileId !== \"\") {\r\n                    this.privProfileId = response.verificationResult.profileId;\r\n                }\r\n            }\r\n        } else {\r\n            this.privErrorDetails = errorDetails;\r\n            this.privProperties.setProperty(CancellationErrorCodePropertyName, CancellationErrorCode[cancellationErrorCode]);\r\n        }\r\n        this.privProperties.setProperty(PropertyId.SpeechServiceResponse_JsonResult, JSON.stringify(response));\r\n    }\r\n\r\n    public get properties(): PropertyCollection {\r\n        return this.privProperties;\r\n    }\r\n\r\n    public get reason(): ResultReason {\r\n        return this.privReason;\r\n    }\r\n\r\n    public get profileId(): string {\r\n        return this.privProfileId;\r\n    }\r\n\r\n    public get errorDetails(): string {\r\n        return this.privErrorDetails;\r\n    }\r\n\r\n    public get score(): number {\r\n        return this.privScore;\r\n    }\r\n}\r\n\r\n/**\r\n * @class SpeakerRecognitionCancellationDetails\r\n */\r\nexport class SpeakerRecognitionCancellationDetails extends CancellationDetailsBase {\r\n\r\n    private constructor(reason: CancellationReason, errorDetails: string, errorCode: CancellationErrorCode) {\r\n        super(reason, errorDetails, errorCode);\r\n    }\r\n\r\n    /**\r\n     * Creates an instance of SpeakerRecognitionCancellationDetails object for the canceled SpeakerRecognitionResult\r\n     * @member SpeakerRecognitionCancellationDetails.fromResult\r\n     * @function\r\n     * @public\r\n     * @param {SpeakerRecognitionResult} result - The result that was canceled.\r\n     * @returns {SpeakerRecognitionCancellationDetails} The cancellation details object being created.\r\n     */\r\n    public static fromResult(result: SpeakerRecognitionResult): SpeakerRecognitionCancellationDetails {\r\n        const reason = CancellationReason.Error;\r\n        let errorCode: CancellationErrorCode = CancellationErrorCode.NoError;\r\n\r\n        if (!!result.properties) {\r\n            errorCode = CancellationErrorCode[result.properties.getProperty(CancellationErrorCodePropertyName, CancellationErrorCode[CancellationErrorCode.NoError]) as keyof typeof CancellationErrorCode];\r\n        }\r\n\r\n        return new SpeakerRecognitionCancellationDetails(reason, result.errorDetails, errorCode);\r\n    }\r\n}\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}